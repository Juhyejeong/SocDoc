<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="test">
	<select id="getContent" resultType="String">
		select email from tbl_test where userid = 'woniyoon'
	</select>
	
	
	<!-- <select id="hospital_select" resultType="com.synergy.socdoc.member.HpInfoVO"> 
		select hpSeq,dept,mainImg,hpName,info
		from hospitalInfo
	</select> -->
	
	<select id="viewMyinfo" parameterType="String" resultType="com.synergy.socdoc.member.MemberVO">
       select userid, email, name, phone, height, weight, bloodType, bloodType, allergy, history, medicine, memberSeq
       ,to_char(birthDate, 'yyyy-mm-dd') AS birthDate
       ,gender
       from member
       where userid = #{userid}
      </select>
      
	<!-- <select id="deptList" resultType="String">
		select distinct nvl(dept,-9999) as dept
		from hospitalInfo
		order by dept
	</select> -->
	
	<!-- <select id="hpinfovoList" parameterType="HashMap" resultType="com.synergy.socdoc.member.HpInfoVO"> 
		select hpSeq,dept,mainImg,hpName,info
		from hospitalInfo
	</select> -->

	<select id="deptIdList" resultType="String">
      select distinct dept
      from hospitalInfo
      order by dept
   </select>

	<!-- <select id="hpinfovoList" resultType="com.synergy.socdoc.member.HpInfoVO"> 
		select hpSeq,dept,mainImg,hpName,info
		from hospitalInfo
	</select>  -->
	
	<select id="hpinfovoList" parameterType="HashMap" resultType="com.synergy.socdoc.member.HpInfoVO">
       select hpSeq,dept,mainImg,hpName,info
      from hospitalInfo
      where 1=1
      <if test="deptIdArr != null">
      and nvl(dept, '-9999') in 
         <foreach collection="deptIdArr" index="i" open="(" separator="," close=")">   <!-- collection명 또는 배열명  -->
               '${deptIdArr[i]}'
         </foreach>
      </if>
      <!-- <if test="gender!=null">
         and func_gender(E.jubun) = #{gender}
      </if> -->
      order by hpSeq
   </select> 

	
</mapper>
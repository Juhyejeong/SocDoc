<?xml version="1.0" encoding="UTF-8"?>

<!-- ==== #29. mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<!-- ==== #29. 루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="hpMem">
	<select id="getHpInfo" parameterType="String" resultType="com.synergy.socdoc.member.HpInfoVO">
		select hpname, dept, address, phone, info, latitude, longitude from hospitalInfo where hpSeq = #{hpSeq}
	</select>

	<select id="getInfoUpdateList" parameterType="String" resultType="com.synergy.socdoc.member.HpInfoVO">
		select submitId, hpName, status, to_char(uploadDate, 'yyyy-mm-dd') as uploadDate from hpApplication where hpseq = #{hpSeq}
	</select>

	<select id="getHpInfoDetail" parameterType="String" resultType="com.synergy.socdoc.member.HpInfoVO">
		select hpname, dept, address, phone, info, mainImg, subImg1, subImg2, reason from hpApplication where submitId = #{submitId}
	</select>
	
	
	<!-- 오픈/클로즈 시간 가져오기 -->
	<resultMap type="HashMap" id="scheduleTbl">
		<result property="day" column="day" javaType="String"></result>
		<result property="open" column="open" javaType="String"></result>
		<result property="close" column="close" javaType="String"></result>
		
	</resultMap>
	
	
	<select id="getScheduleTbl" parameterType="String" resultMap="scheduleTbl">
		select s.day as day, s.open as open, t.hour as close
		from
		(select s.day, s.close, t.hour as open
		from scheduleEdit s left join
		     timetable t
		     on s.open = t.hourSeq and s.submitid = 'e35tnqv64ag'
		)s
		join timetable t
		on s.close = t.hourSeq
		order by day asc
	</select>
</mapper>